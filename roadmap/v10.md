# v10 — 營運化與擴張（監控/告警/成本/版本/未來會員牆）

## 目標
把 Rocket Screener 從「可跑」升級到「可運營、可擴張、可控成本」：
- 監控：成功率、耗時、成本、輸出品質指標
- 告警：08:00 任務失敗即通知（Slack/Email）
- 成本控管：快取、批次、分段生成、模型分工
- 版本化：prompt、模板、估值假設都可追溯（可回測）
- 未來會員牆：從全免費 → 文章 2/3 轉會員/付費（只改 config）

---

## 範圍（Scope）
### 會做
- Observability：
  - structured logs（JSON）
  - metrics（每步耗時、API call 數、token 用量（若可得））
  - dashboard（可選：Grafana/Prometheus）
- Alerting：
  - cron + 失敗通知
  - 或 workflow engine（Airflow/Prefect/Argo，視內部環境）
- 成本策略：
  - transcript / news / filings 的快取策略
  - LLM 兩段式：抽取（便宜）→ 寫作（主力）
- Prompt/versioning：
  - `prompts/` 以版本號存檔（例如 `article2_v3.md`）
  - 每次發文記錄 prompt version + data hash
- Membership toggle：
  - config 控制：文章 2/3 是否 members-only/paid-only
  - newsletter 仍只寄文章 1（或未來可加 premium digest）

---

## 交付物（Deliverables）
- `ops/cron.md` 或 `deploy/`（依你們環境）
- `ops/alerts.py`
- `prompts/` 版本化策略文件
- `config/feature_flags.yaml`（membership toggle）

---

## 驗收標準（Definition of Done）
- [ ] 連續 14 天可穩定 08:00 發佈（可用 staging 測）
- [ ] 失敗會告警且可一鍵重跑（不重複寄信）
- [ ] 任一篇文章可回溯：
  - 當天資料來源 hash
  - prompt/template version
  - 估值假設
- [ ] 切換會員牆只需改 config，不需改程式


