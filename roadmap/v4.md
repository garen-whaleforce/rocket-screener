# v4 — 估值引擎 + 估值圖（文章 2 核心護城河）

## 目標
把 Rocket Screener 的核心護城河做出來：**文章 2 必含「估值模型圖（像 Excel）」+ Bull/Base/Bear 合理價區間**，且數字 100% 可追溯。

---

## 範圍（Scope）
### 會做
- 估值引擎（Valuation Engine v1）
  - 三層價格：
    1) 短期（2–4 週）：波動/事件區間（ATR 或 20D vol）
    2) 中期（3–6 月）：Forward 倍數法（NTM EPS × multiple）
    3) 長期（12–24 月）：簡化 FCF multiple 或簡化 DCF（可先做 FCF multiple）
  - 情境：Bull / Base / Bear  
    - 每個情境的假設差異要明確（growth、margin、multiple 或 discount rate）
- Garen Valuation Sheet v1（PNG）
  - 以 deterministic 方式生成：**HTML+CSS→截圖** 或 `matplotlib table`
  - 圖內包含：輸入假設 + 輸出合理價 + downside/upside
- 文章 2：加入「估值與合理價」章節（強制）
- 估值圖上傳 Ghost，插入文章 2（並可設為 feature image）

### 不做
- transcript 自動抽取（v5）
- SEC 驗證（v6）
- 13F（v7）

---

## 交付物（Deliverables）
- `valuation/engine.py`：估值計算（輸入 Evidence Pack，輸出 prices + assumptions）
- `valuation/render_sheet.py`：渲染估值表 PNG（deterministic）
- `publish/ghost_client.py`：支援 image upload + 回寫 URL
- 文章 2 的 Evidence Pack schema 更新（加入 valuation fields）
- `templates/article2.md` 更新（加入估值圖位置與說明文字）

---

## Garen Valuation Sheet v1（建議欄位）
最小版本（先做這些就夠吸引受眾）：

- Header：{Company} ({Ticker})｜{Date}｜現價 {Price}
- Inputs：
  - NTM EPS（或你們能穩定取得的指標）
  - 倍數（Bull/Base/Bear）
  - 風險調整（可先以倍數表示）
- Outputs：
  - 中期合理價（3–6m）：Bull/Base/Bear
  - 下行保護（Bear downside %）
  - 上行空間（Bull upside %）
- 旁註（3 行）：非共識重點 + 最大風險 + 下一催化

> 注意：每個輸入數字必須附來源欄位（FMP/SEC/計算）

---

## 驗收標準（Definition of Done）
- [ ] 文章 2 每天都能生成估值圖（PNG）
- [ ] 估值圖內所有數字都可追溯（從 Evidence Pack/計算結果）
- [ ] 文章 2 必定包含 Bull/Base/Bear 合理價區間（短/中/長至少中期一定有）
- [ ] 若估值圖生成失敗，有降級策略：
  - 自動改為 Markdown 表格（仍含合理價區間）  
  - 但不得阻塞發佈

---

## 下一版（v5）會加什麼
- transcript 取得與結構化抽取（管理層指引/風險/語氣）用來強化估值假設與非共識洞察

